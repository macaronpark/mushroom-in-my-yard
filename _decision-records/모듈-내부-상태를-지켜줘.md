### GameState 내부 상태를 지켜줘

- 문제
  - 상태 보안이 중요한 모듈의 **캡슐화가 안되어 있음**
  - 외부에서 `GameState.fields = null`처럼 내부 상태 직접 변경 가능

- 원인
  - 초기 개발 속도를 위해 object literal 형태로 작성

- 고민한 지점/대안
  1. **IIFE**
     - 장점: 클로저 스코프를 활용해 상태 은닉 가능
     - 단점: 즉시 실행되어 재생성 어려움 -> 테스트/리셋 불편, 재사용성 낮음
  2. **팩토리 함수 패턴**
     - 장점: 상태 은닉 가능. 호출 시마다 새 인스턴스 생성 가능 -> 테스트, 병렬 실행 용이
     - 단점: 싱글톤 제약이 필요한 경우 별도의 제어 코드/규칙 필요

- 최종 선택
  - **팩토리 함수 패턴**
  - 이유
    - 테스트 시 깨끗한 상태로 **모듈을 재생성**할 수 있음. **병렬 테스트도 안전**
  - 추가 규칙
    - 싱글톤이 필요한 경우 `default export`(정문)로 인스턴스 내보내도록 규칙화 함
    - 테스트를 위한 create 함수는 `named export`(쪽문)로 내보내도록 규칙화 함
  - 관련 커밋
    - [refactor: GameState 캡슐화를 위한 팩토리 함수 패턴 적용](https://github.com/macaronpark/mushroom-in-my-yard/pull/8/commits/11e096593bba541cf375c408d50c4ff8d9160ad1)
    - [test: GameState 공개 API를 사용해 테스트하도록 수정](https://github.com/macaronpark/mushroom-in-my-yard/pull/8/commits/a4f205c5a2398356604ace6efb571c9baa42a1cf)

- 배운 점
  - 테스트와 상태 관리가 중요한 경우, 팩토리 함수 패턴이 단순하면서도 강력
  - 의도치 않은 상태 변경을 방지하고 유지보수성을 높이기 위해 캡슐화 필수
  - 상태 스코프를 명확히 분리하는 구조는 장기 유지보수에 유리하다
